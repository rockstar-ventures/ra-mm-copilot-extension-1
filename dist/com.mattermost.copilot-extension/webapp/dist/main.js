(()=>{"use strict";var t={900:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(n(7)),r=o(n(947));window.registerPlugin(r.default.id,new i.default)},947:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={id:"com.mattermost.copilot-extension",version:"1.0.0"}},7:function(t,e){var n=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function s(t){try{u(o.next(t))}catch(t){r(t)}}function l(t){try{u(o.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,l)}u((o=o.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.originalFetch=window.fetch.bind(window)}initialize(t,e){return n(this,void 0,void 0,(function*(){window.fetch=(t,e)=>n(this,void 0,void 0,(function*(){const n="string"==typeof t?t:t instanceof URL?t.toString():t.url;return n.includes("/api/v1/copilot")||n.includes("/mattermost-copilot/")?this.handleCopilotRequest(n,e):this.originalFetch(t,e)})),console.log("Copilot extension plugin initialized")}))}handleCopilotRequest(t,e){return n(this,void 0,void 0,(function*(){try{const n=(null==e?void 0:e.body)?JSON.parse(e.body):{},o=this.getMattermostContext(),i=yield this.originalFetch("your-backend-url/api/copilot",{method:"POST",headers:Object.assign({"Content-Type":"application/json"},(null==e?void 0:e.headers)||{}),body:JSON.stringify({original_request:n,mattermost_context:o,original_url:t})}),r=yield i.json();return new Response(JSON.stringify(this.transformResponse(r)),{status:200,headers:{"Content-Type":"application/json"}})}catch(n){return console.error("Error in Copilot interceptor:",n),this.originalFetch(t,e)}}))}getMattermostContext(){var t,e,n,o,i,r,s;try{const l=null===(t=null===window||void 0===window?void 0:window.store)||void 0===t?void 0:t.getState();return{currentTeam:null===(n=null===(e=null==l?void 0:l.entities)||void 0===e?void 0:e.teams)||void 0===n?void 0:n.currentTeamId,currentChannel:null===(i=null===(o=null==l?void 0:l.entities)||void 0===o?void 0:o.channels)||void 0===i?void 0:i.currentChannelId,currentUser:null===(s=null===(r=null==l?void 0:l.entities)||void 0===r?void 0:r.users)||void 0===s?void 0:s.currentUserId}}catch(t){return console.error("Error getting Mattermost context:",t),{}}}transformResponse(t){return{type:"copilot_response",text:t.response||"",suggestions:t.suggestions||[],metadata:t.metadata||{}}}}}},e={};!function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}(900)})();